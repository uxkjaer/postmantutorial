/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./CommandShortcutHints","./Popup","./InvisibleText"],function(t,i,e){"use strict";var n=function(t){this._shortcutHintOptions=t;this._attachCommand=s;this._getHintPopup=l;this._createShortcutHintPopup=p;this._getShortcutHintRef=u;this._getShortcutHintText=a;this._updateShortcutHintAccLabel=m;this.showShortcutHint=c;this.hideShortcutHint=h};n.init=function(t){o.call(t)};function o(){this.attachEvent("EventHandlerChange",function(t){var i=t.getParameter("func");if(t.getParameter("type")==="listenerAttached"&&i&&i._sapui_commandName){this._attachCommand(i._sapui_commandName)}})}function s(i){t.register(this,i);var e={onAfterRendering:function(){var t=r.call(this),i,e;if(t){i=document.getElementById(t);i.setAttribute("aria-keyshortcuts",this._getShortcutHintText());e=i.getAttribute("title");if(e){i.removeAttribute("title");this._titleAttribute=e}}}};this.addEventDelegate(e,this)}function r(){if(this._shortcutHintOptions&&this._shortcutHintOptions.domrefid){return this._shortcutHintOptions.domrefid}if(this._shortcutHintOptions&&this._shortcutHintOptions.domrefid_suffix){return this.getId()+this._shortcutHintOptions.domrefid_suffix}return this.getId()}function u(){return document.getElementById(r.call(this))}function c(){var t,e=this._shortcutHintOptions&&this._shortcutHintOptions.position||"0 8",n=i.Dock.CenterTop,o=i.Dock.CenterBottom,s=this._getHintPopup(),r=this._getShortcutHintRef(),u=this._getShortcutHintText();if(!d(r)||!f(r)){return}if(this._titleAttribute){u=this._titleAttribute+" ("+u+")"}if(!s){s=this._createShortcutHintPopup(u)}s.oContent.children[0].textContent=u;if(!s.isOpen()){s.open(1e3,n,o,r,e,"flip",function(i){s.oContent.style.visibility="hidden";if(t){clearTimeout(t)}t=setTimeout(function(){if(!d(r)||!f(r)){return}s.oContent.style.visibility="visible"},1e3);s._applyPosition(s._oLastPosition)})}}function h(){var t=this._getHintPopup();if(t&&t.isOpen()){t.close()}}function a(){var i=t.getCommandForControl(this.getId());if(i){return i.shortcut}}function f(t){var i;if(!t){return false}i=t.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)}function d(t){return t.offsetWidth>0||t.offsetHeight>0||t.getClientRects().length>0}function l(){return n._popup}function p(t){var e,o,s;o=document.createElement("span");o.classList.add("sapUiHintContainer");s=document.createElement("div");s.classList.add("sapUiHintText");s.textContent=t;o.appendChild(s);e=new i(o,false,false,false);e.setAnimations(function(t,i,e){setTimeout(e,i)},function(t,i,e){e()});n._popup=e;return e}function m(){var t,i,e;if(!this._shortcutHintOptions.addAccessibilityLabel){return}t=_();i=t.getId();e=this._getShortcutHintRef();t.setText(this._titleAttribute);if(t.getText()){g(e,"aria-describedby",i)}else{H(e,"aria-describedby",i)}}function _(){if(!n._invisibleText){n._invisibleText=new e;n._invisibleText.toStatic()}return n._invisibleText}function g(t,i,e,n){var o=t.getAttribute(i);if(!o){t.setAttribute(i,e);return}var s=o.split(" ");if(s.indexOf(e)==-1){n?s.unshift(e):s.push(e);t.setAttribute(i,s.join(" "))}}function H(t,i,e){var n=t.getAttribute(i)||"",o=n.split(" "),s=o.indexOf(e);if(s==-1){return}o.splice(s,1);if(o.length){t.setAttribute(i,o.join(" "))}else{t.removeAttribute(i)}return this}return n});